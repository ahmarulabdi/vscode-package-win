module.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t){e.exports=require("vscode")},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function a(e){try{r(i.next(e))}catch(e){s(e)}}function c(e){try{r(i.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}r((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(11),s=n(12),a=n(13),c=n(14),r=n(2),l=n(0),u=new Map;u.set("darwin","osx"),u.set("win32","windows");const h=u.get(c.platform())||"linux",d="windows"===h?void 0:l.workspace.getConfiguration().get(`terminal.integrated.shell.${h}`);t.Utils=class{static normalizePath(e){return e.replace(/\\\\/,"/")}static pathTrimRelative(e){return e.replace("./","")}static getDirectoryFromFilename(e){return e.replace(/[^\/]*$/,"")}static getSchemaFromNodeModules(e,t,n){return this.parseJSONFile(this.getNodeModulesPath(e,t,n))}static getSchemaFromLocal(e,t){return this.parseJSONFile(r.join(e,t))}static getNodeModulesPath(e,...t){return r.join(e,"node_modules",...t)}static readFileAsync(e){return a.promisify(s.readFile)(e,"utf8")}static existsAsync(e){return a.promisify(s.exists)(e)}static execAsync(e,t){return new Promise((n,i)=>{o.exec(e,{cwd:t,shell:d},(e,t,o)=>{e?i([t,o]):n(t)})})}static parseJSONFile(e){return i(this,void 0,void 0,(function*(){let t=null;try{let n=yield this.readFileAsync(e);e.includes("@angular/material")&&(n=n.split("\n").map(e=>e.replace(/^ *\/\/.*/,"")).join("\n")),t=JSON.parse(n)}catch(e){}return t}))}static isSchemaLocal(e){return e.startsWith(".")&&e.endsWith(".json")}}},function(e,t){e.exports=require("path")},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function a(e){try{r(i.next(e))}catch(e){s(e)}}function c(e){try{r(i.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}r((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),s=n(0),a=n(1);class c{static init(e){return i(this,void 0,void 0,(function*(){this.initialized||(yield this.initAngularConfig(e),this.isIvy=yield this.detectIsIvy(e),this.initialized=!0),console.log(this.isIvy)}))}static initAngularConfig(e){return i(this,void 0,void 0,(function*(){const t=o.join(e,this.configPath);(yield a.Utils.existsAsync(t))&&(this.config=yield a.Utils.parseJSONFile(t),this.defaultCollection=this.getDefaultCollection(this.config),this.projects=this.getProjects(this.config),this.watcher||(this.watcher=s.workspace.createFileSystemWatcher(t,!0,void 0,!0),this.watcher.onDidChange(()=>{this.config=null,this.init(e)})))}))}static detectIsIvy(e){return i(this,void 0,void 0,(function*(){const t=o.join(e,this.tsConfigPath),n=o.join(e,this.packageJSONPath);if((yield a.Utils.existsAsync(t))&&(yield a.Utils.existsAsync(n))){const e=yield a.Utils.parseJSONFile(t),i=yield a.Utils.parseJSONFile(n);if(e&&i&&i.dependencies){const t=(i.dependencies["@angular/core"]||"0").replace("^","").replace("~",""),n=Number.parseInt(t.substr(0,1),10);let o;if(e&&e.angularCompilerOptions&&"enableIvy"in e.angularCompilerOptions&&(o=e.angularCompilerOptions.enableIvy),8===n&&!0===o)return!0;if(n>=9&&!1!==o)return!0}}return!1}))}static getDefaultCollection(e){if(e&&e.cli){if(e.cli.defaultCollection)return e.cli.defaultCollection;if(e.cli.schematics&&e.cli.schematics.defaultCollection)return e.cli.schematics.defaultCollection}return this.cliCollection}static getProjects(e){const t=new Map;if(e&&e.projects)for(const n in e.projects)if(e.projects.hasOwnProperty(n)){let i=e.projects[n].root||e.projects[n].sourceRoot;i&&("src"===(i=i.endsWith("/")?i.slice(0,-1):i)&&(this.rootProject=n),t.set(n,i))}return t}}t.AngularConfig=c,c.configPath="angular.json",c.packageJSONPath="package.json",c.tsConfigPath="tsconfig.json",c.cliCollection="@schematics/angular",c.defaultCollection="@schematics/angular",c.projects=new Map,c.rootProject="",c.isIvy=!1,c.initialized=!1,c.config=null},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),o=n(15);class s{static init(){this.event||(this.event=i.workspace.onDidChangeConfiguration(()=>{this.schematics=null,this.componentTypes=null}))}static getSchematics(){if(!this.schematics){const e=i.workspace.getConfiguration().get("ngschematics.schematics",[]);this.schematics=[...o.defaultSchematics,...e]}return this.schematics}static getComponentTypes(e){if(!this.componentTypes){const e=i.workspace.getConfiguration().get("ngschematics.componentTypes",{});this.componentTypes={exported:[...o.defaultComponentTypes.exported,...e.exported||[]],pure:[...o.defaultComponentTypes.pure,...e.pure||[]],page:[...o.defaultComponentTypes.page,...e.page||[]],runtime:[...o.defaultComponentTypes.runtime,...e.runtime||[]],element:[...o.defaultComponentTypes.element,...e.element||[]]}}return this.componentTypes[e].map(e=>e.toLowerCase())}}t.Preferences=s,s.schematics=null,s.componentTypes=null},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function a(e){try{r(i.next(e))}catch(e){s(e)}}function c(e){try{r(i.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}r((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=n(10),a=n(1);class c{constructor(e){this.path="",this.schemas=new Map,this.name=e}get schemasNames(){return Array.from(this.schemas.keys()).sort()}load(e){return i(this,void 0,void 0,(function*(){let t=null;const n=c.cache.get(this.name);if(n)t=n;else if(a.Utils.isSchemaLocal(this.name))(t=yield a.Utils.getSchemaFromLocal(e,this.name))&&(t.path=a.Utils.getDirectoryFromFilename(this.name));else{const n=yield a.Utils.getSchemaFromNodeModules(e,this.name,"package.json");if(!n||!n.schematics)return!1;(t=yield a.Utils.getSchemaFromNodeModules(e,this.name,a.Utils.pathTrimRelative(n.schematics)))&&(t.path=a.Utils.pathTrimRelative(n.schematics))}return!!t&&(this.path=t.path,yield this.initSchemasMap(t,e),c.cache.set(this.name,t),!0)}))}createSchema(e,t){return i(this,void 0,void 0,(function*(){let n=this;const i=this.schemas.get(e);if(i.extends){const[e]=i.extends.split(":");n=new c(e),yield n.load(t)}return new s.Schema(e,n)}))}askSchema(){return i(this,void 0,void 0,(function*(){const e=this.schemasNames.map(e=>({label:e,description:this.schemas.get(e).description})),t=yield o.window.showQuickPick(e,{placeHolder:"What do you want to generate?",ignoreFocusOut:!0});return t?t.label:void 0}))}initSchemasMap(e,t){return i(this,void 0,void 0,(function*(){for(let n in e.schematics)if(e.schematics.hasOwnProperty(n)&&!e.schematics[n].hidden&&"ng-add"!==n){const i=e.schematics[n];if(i.extends){const[e,o]=i.extends.split(":"),s=new c(e);yield s.load(t);const a=Object.assign({},s.schemas.get(o));a.extends=i.extends,this.schemas.set(n,a)}else this.schemas.set(n,e.schematics[n])}}))}}t.Collection=c,c.cache=new Map},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function a(e){try{r(i.next(e))}catch(e){s(e)}}function c(e){try{r(i.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}r((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),s=n(0),a=n(1),c=n(3),r=n(4);class l{static load(e){return i(this,void 0,void 0,(function*(){const t=r.Preferences.getSchematics(),n=[];for(let i of t)if(this.collections.has(i))n.push(i);else{let t=!1;(t=a.Utils.isSchemaLocal(i)?yield a.Utils.existsAsync(o.join(e,i)):yield a.Utils.existsAsync(a.Utils.getNodeModulesPath(e,i)))&&n.push(i)}this.collections=new Set([c.AngularConfig.defaultCollection,c.AngularConfig.cliCollection,...n])}))}static askSchematic(){return i(this,void 0,void 0,(function*(){return 1===this.collections.size?c.AngularConfig.cliCollection:s.window.showQuickPick(Array.from(this.collections),{placeHolder:"From which schematics collection?",ignoreFocusOut:!0})}))}}t.Schematics=l,l.collections=new Set},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);class o{static get channel(){return this._channel||(this._channel=i.window.createOutputChannel("Angular schematics")),this._channel}static dispose(){this._channel&&this._channel.dispose()}}t.Output=o,o._channel=null},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function a(e){try{r(i.next(e))}catch(e){s(e)}}function c(e){try{r(i.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}r((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=n(9),a=n(16),c=n(7),r=n(3);t.activate=function(e){return i(this,void 0,void 0,(function*(){o.commands.executeCommand("setContext","inAngularProject",!0),o.window.registerTreeDataProvider("angular-schematics",new s.AngularSchematicsProvider);const t=o.commands.registerCommand("ngschematics.generateComponent",e=>i(this,void 0,void 0,(function*(){yield a.Commands.generate(e,{collectionName:r.AngularConfig.cliCollection,schemaName:"component"})}))),n=o.commands.registerCommand("ngschematics.generateService",e=>i(this,void 0,void 0,(function*(){yield a.Commands.generate(e,{collectionName:r.AngularConfig.cliCollection,schemaName:"service"})}))),c=o.commands.registerCommand("ngschematics.generateModule",e=>i(this,void 0,void 0,(function*(){yield a.Commands.generate(e,{collectionName:r.AngularConfig.cliCollection,schemaName:"module"})}))),l=o.commands.registerCommand("ngschematics.generate",(e,t={})=>i(this,void 0,void 0,(function*(){yield a.Commands.generate(e,t)})));e.subscriptions.push(t,n,c,l)}))},t.deactivate=function(){c.Output.dispose()}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function a(e){try{r(i.next(e))}catch(e){s(e)}}function c(e){try{r(i.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}r((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),s=n(0),a=n(5),c=n(6),r=n(1);t.AngularSchematicsProvider=class{constructor(){this.workspaceRoot="",this.defaultIconPath="",this.materialIconsPath="",this.materialIconsMap=new Map([["default","angular.svg"],["component","angular-component.svg"],["directive","angular-directive.svg"],["guard","angular-guard.svg"],["pipe","angular-pipe.svg"],["service","angular-service.svg"],["appShell","angular.svg"],["application","angular.svg"],["class","angular.svg"],["enum","angular.svg"],["interface","angular.svg"],["library","angular.svg"],["module","angular.svg"],["serviceWorker","angular.svg"],["universal","angular.svg"],["@ngrx/schematics:action","ngrx-actions.svg"],["@ngrx/schematics:effect","ngrx-effects.svg"],["@ngrx/schematics:entity","ngrx-entity.svg"],["@ngrx/schematics:reducer","ngrx-reducer.svg"],["@ngrx/schematics","ngrx-state.svg"],["@ionic/angular-toolkit","ionic.svg"]]),this.materialIconsExisting=new Set,this.materialIconsNotExisting=new Set,s.workspace.workspaceFolders&&(this.workspaceRoot=s.workspace.workspaceFolders[0].uri.fsPath);const e=s.extensions.getExtension("cyrilletuzi.angular-schematics");if(this.defaultIconPath=o.join(e.extensionPath,"angular.svg"),"material-icon-theme"===s.workspace.getConfiguration("workbench").get("iconTheme")){const e=s.extensions.getExtension("PKief.material-icon-theme");e&&(this.materialIconsPath=o.join(e.extensionPath,"icons"))}}getTreeItem(e){return e}getChildren(e){return i(this,void 0,void 0,(function*(){if(this.workspaceRoot){if(!e)return yield c.Schematics.load(this.workspaceRoot),Array.from(c.Schematics.collections).map(e=>new s.TreeItem(e,s.TreeItemCollapsibleState.Expanded));{const t=new a.Collection(e.label),n=[];if(yield t.load(this.workspaceRoot)){for(const e of t.schemasNames){const i=new s.TreeItem(e,s.TreeItemCollapsibleState.None);i.command={title:`Generate ${e}`,command:"ngschematics.generate",arguments:[null,{collectionName:t.name,schemaName:e}]},i.iconPath=yield this.getIconPath(t.name,e),n.push(i)}return n}}}return[]}))}getIconPath(e,t){return i(this,void 0,void 0,(function*(){let n=this.defaultIconPath;if(this.materialIconsPath){let i="";this.materialIconsMap.has(t)?i=o.join(this.materialIconsPath,this.materialIconsMap.get(t)):this.materialIconsMap.has(`${e}:${t}`)?i=o.join(this.materialIconsPath,this.materialIconsMap.get(`${e}:${t}`)):this.materialIconsMap.has(e)?i=o.join(this.materialIconsPath,this.materialIconsMap.get(e)):o.join(this.materialIconsPath,this.materialIconsMap.get("default")),i&&(this.materialIconsExisting.has(i)?n=i:!this.materialIconsNotExisting.has(i)&&(yield r.Utils.existsAsync(i))?(this.materialIconsExisting.add(i),n=i):this.materialIconsNotExisting.add(i))}return s.Uri.file(n)}))}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function a(e){try{r(i.next(e))}catch(e){s(e)}}function c(e){try{r(i.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}r((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),s=n(0),a=n(1);class c{constructor(e,t){this.path="",this.requiredOptions=[],this.options=new Map,this.name=e,this.collection=t}get optionsNames(){return Array.from(this.options.keys()).sort()}load(e){return i(this,void 0,void 0,(function*(){let t=null;const n=c.cache.get(`${this.collection}:${this.name}`);return n?t=n:(this.path=o.join(a.Utils.getDirectoryFromFilename(this.collection.path),a.Utils.pathTrimRelative(this.collection.schemas.get(this.name).schema)),t=a.Utils.isSchemaLocal(this.collection.name)?yield a.Utils.getSchemaFromLocal(e,this.path):yield a.Utils.getSchemaFromNodeModules(e,this.collection.name,this.path)),!!t&&(this.initOptionsMap(t),this.requiredOptions=t.required||[],c.cache.set(`${this.collection}:${this.name}`,t),!0)}))}hasDefaultOption(){for(let e of this.options.values())if(e.$default&&"argv"===e.$default.$source&&0===e.$default.index||this.requiredOptions.includes("name"))return!0;return!1}hasPath(){return this.options.has("path")}askDefaultOption(e="",t=""){return i(this,void 0,void 0,(function*(){let n=`Name or path/name ${t?`in project '${t}'`:"in default project"}?`;return e&&t||(n=`${n} Pro-tip: the path and project can be auto-inferred if you launch the command with a right-click on the directory where you want to generate.`),s.window.showInputBox({prompt:n,value:e,valueSelection:[e.length,e.length],ignoreFocusOut:!0})}))}askOptions(){return i(this,void 0,void 0,(function*(){const e=[];this.options.forEach((t,n)=>{if(!(!1===t.visible||"x-deprecated"in t||t.$default&&"argv"===t.$default.$source)){const i=!("$default"in t||!(this.requiredOptions.includes(n)||"x-prompt"in t)),o="$default"in t||!this.requiredOptions.includes(n)?"":"(required) ",s="$default"in t||o||!("x-prompt"in t)?"":"(suggested) ";e.push({label:n,description:`${o}${s}${t.description}`,picked:i})}});const t=[...e.filter(e=>e.picked).sort((e,t)=>e.label.localeCompare(t.label)),...e.filter(e=>!e.picked).sort((e,t)=>e.label.localeCompare(t.label))];return((yield s.window.showQuickPick(t,{canPickMany:!0,placeHolder:"Do you need some options? (if not, just press Enter to skip this step)",ignoreFocusOut:!0}))||[]).map(e=>e.label)}))}askOptionsValues(e){return i(this,void 0,void 0,(function*(){const t=this.filterSelectedOptions(e),n=new Map;for(let[e,i]of t){let t="";const o=i["x-prompt"],a=o&&o.message?o.message:i.description;if(void 0!==i.enum)t=yield this.askEnumOption(e,i.enum,a);else if("boolean"===i.type){const n=!0===i.default?["false","true"]:["true","false"];t=yield this.askEnumOption(e,n,a)}else t="array"===i.type&&o&&o.items?o.multiselect?yield this.askMultiselectOption(e,o.items,a):yield this.askEnumOption(e,o.items,a):yield s.window.showInputBox({placeHolder:`--${e}`,prompt:a,ignoreFocusOut:!0});t&&n.set(e,t)}return n}))}askEnumOption(e,t,n=""){return i(this,void 0,void 0,(function*(){return s.window.showQuickPick(t,{placeHolder:`--${e}${n?`: ${n}`:""}`,ignoreFocusOut:!0})}))}askMultiselectOption(e,t,n=""){return i(this,void 0,void 0,(function*(){return s.window.showQuickPick(t,{placeHolder:`--${e}${n?`: ${n}`:""}`,canPickMany:!0,ignoreFocusOut:!0})}))}initOptionsMap(e){for(let t in e.properties)e.properties.hasOwnProperty(t)&&this.options.set(t,e.properties[t])}filterSelectedOptions(e){const t=new Map;return e.forEach(e=>{const n=this.options.get(e);n&&t.set(e,n)}),this.requiredOptions.forEach(e=>{const n=this.options.get(e);"name"===e||!n||"$default"in n||t.set(e,this.options.get(e))}),t}}t.Schema=c,c.cache=new Map},function(e,t){e.exports=require("child_process")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("os")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSchematics=["@angular/material","@ionic/angular-toolkit","@ngrx/schematics","@ngxs/schematics","@nativescript/schematics","@nrwl/schematics","@nstudio/schematics","@ngx-formly/schematics","primeng-schematics","@ngx-kit/collection","ngx-spec","./schematics/collection.json"],t.defaultComponentTypes={pure:["pure","ui","presentation","presentational","dumb"],page:["page","container","smart","routed","route"],runtime:["dialog","snackbar","bottomsheet","modal","popover","entry"],exported:["exported","lib"],element:["element"]}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function a(e){try{r(i.next(e))}catch(e){s(e)}}function c(e){try{r(i.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}r((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),s=n(0),a=n(5),c=n(17),r=n(7),l=n(6),u=n(1),h=n(3),d=n(18),p=n(4);t.Commands=class{static getContextPath(e){return"object"==typeof e&&null!==e&&"path"in e?e.path:""}static getDefaultWorkspace(){return s.workspace.workspaceFolders&&1===s.workspace.workspaceFolders.length?s.workspace.workspaceFolders[0]:null}static getWorkspaceFolderPath(e=""){return i(this,void 0,void 0,(function*(){const t=e?s.workspace.getWorkspaceFolder(s.Uri.file(e)):this.getDefaultWorkspace()||(yield s.window.showWorkspaceFolderPick());return t?t.uri.fsPath:""}))}static generate(e,{collectionName:t,schemaName:n}={}){return i(this,void 0,void 0,(function*(){const i=!(!t||!n),o=this.getContextPath(e),s=yield this.getWorkspaceFolderPath(o);if(!s)return;p.Preferences.init(),yield h.AngularConfig.init(s),yield d.TSLintConfig.init(s);const r=new c.Generate(o,s);if(t!==h.AngularConfig.cliCollection){if(yield l.Schematics.load(s),!t&&!(t=yield l.Schematics.askSchematic()))return;r.addCollection(t),"ngx-spec"===t&&r.resetCommandPath(o)}const u=new a.Collection(t);if(!(yield u.load(s)))return;if(!n&&!(n=yield u.askSchema()))return;r.addSchema(n);const m=yield u.createSchema(n,s);if(!(yield m.load(s)))return;let f,g;if(m.hasDefaultOption()){if(!(f=yield m.askDefaultOption(r.path,r.project)))return;f.endsWith(`.${n}`)&&(f=f.replace(`.${n}`,"")),r.addDefaultOption(f,m.hasPath())}if(!(g=i&&t===h.AngularConfig.cliCollection&&"component"===n?yield this.askComponentOptions(m):i&&t===h.AngularConfig.cliCollection&&"module"===n?yield this.askModuleOptions(m,f):yield this.askOptions(m)))return;g.forEach((e,t)=>{r.addOption(t,e)}),(yield r.askConfirmation())&&(yield this.launchCommand(r,s))}))}static launchCommand(e,t){return i(this,void 0,void 0,(function*(){r.Output.channel.show(),r.Output.channel.appendLine(e.command);try{const n=yield u.Utils.execAsync(yield e.getExecCommand(t),t);r.Output.channel.appendLine(n),yield s.commands.executeCommand("workbench.files.action.refreshFilesExplorer"),s.window.setStatusBarMessage("Schematics worked!",5e3);try{yield this.jumpToFile(n,t,e.defaultOption,e.schema)}catch(e){}}catch(e){r.Output.channel.append(e[0]),r.Output.channel.appendLine(e[1]),s.window.showErrorMessage("Schematics failed, see Output.")}}))}static jumpToFile(e,t,n,a){return i(this,void 0,void 0,(function*(){const i=n.includes("/")?n.substr(n.lastIndexOf("/")+1):n,c=new RegExp(`CREATE (.*${i}(?:.${a})?.ts)`),r=e.match(c);if(r){const e=yield s.workspace.openTextDocument(o.join(t,r[1]));yield s.window.showTextDocument(e)}}))}static askOptions(e){return i(this,void 0,void 0,(function*(){const t=yield e.askOptions();return t?yield e.askOptionsValues(t):new Map}))}static askComponentOptions(e){return i(this,void 0,void 0,(function*(){const t=p.Preferences.getComponentTypes("exported"),n=p.Preferences.getComponentTypes("pure"),i=p.Preferences.getComponentTypes("page"),o=p.Preferences.getComponentTypes("runtime"),a=p.Preferences.getComponentTypes("element"),c=[...i,...o],r=h.AngularConfig.isIvy?[]:[...a,...o],l=[...n,...t],u=new Map;let m="";const f=d.TSLintConfig.componentSuffixes.map(e=>{const s=e.toLowerCase();let c="";return"component"===s&&(c="Component with no special behavior"),n.includes(s)?c="Pure presentation / UI component":i.includes(s)?c=`Component associated to a route${h.AngularConfig.isIvy?" or modals/dialogs":""}`:o.includes(s)?c="Runtime component, like dialogs or modals":t.includes(s)?c="Shared component used outside of its own module":a.includes(s)&&(c="Angular Element, ie. a native Web Component"),{label:e,description:c}}),g=yield s.window.showQuickPick(f,{placeHolder:"What type of component do you want?",ignoreFocusOut:!0});g&&"component"!==(m=g.label.toLowerCase())&&e.options.get("type")&&d.TSLintConfig.userComponentSuffixes.includes(g.label)&&u.set("type",m);const y=[];e.options.get("skipSelector")&&y.push({label:"No selector",description:"--skip-selector",picked:!(!m||!c.includes(m)),detail:"Recommended for routed components and modals/dialogs"}),y.push({label:"Pure",description:"--change-detection OnPush",picked:!(!m||!l.includes(m)),detail:"Recommended to optimize UI / presentation components"}),y.push({label:"Exported",description:"--export",picked:!(!m||!t.includes(m)),detail:" Required for reusable components consumed outside of their own module"});const v=e.options.get("entryComponent");!h.AngularConfig.isIvy&&v&&y.push({label:"Entry",description:"--entry-component",picked:!(!m||!r.includes(m)),detail:"Required for runtime components like modals/dialogs and Angular Elements"});const w=e.options.get("viewEncapsulation");w&&w.enum&&w.enum.includes("ShadowDom")&&y.push({label:"Shadow",description:"--view-encapsulation ShadowDom",picked:!(!m||!a.includes(m)),detail:"Recommended for Angular Elements, doesn't work in IE/Edge"}),y.push({label:"Advanced",detail:"I need to add other advanced options"});const C=yield s.window.showQuickPick(y,{canPickMany:!0,placeHolder:"Do you want special component behavior(s)? (otherwise just press Enter)",ignoreFocusOut:!0});if(C){const t=C.map(e=>e.label);if(t.includes("Exported")&&u.set("export","true"),t.includes("Pure")&&u.set("changeDetection","OnPush"),t.includes("No selector")&&u.set("skipSelector","true"),t.includes("Entry")&&u.set("entryComponent","true"),t.includes("Shadow")&&u.set("viewEncapsulation","ShadowDom"),t.includes("Advanced")){const t=yield this.askOptions(e);for(const[e,n]of t)u.set(e,n)}}return u}))}static askModuleOptions(e,t){return i(this,void 0,void 0,(function*(){const n=[{label:"Classic module",description:"No option"},{label:"Classic module, imported",description:"--module app (no other option)"},{label:"Module with routing, imported",description:"--routing --module app (no other option)"}];t&&e.options.get("route")&&n.push({label:"Lazy-loaded module",description:`--route ${t} --module app`}),n.push({label:"Advanced module",description:"You'll be able to choose all available options"});const i=yield s.window.showQuickPick(n,{placeHolder:"What type of module do you want?",ignoreFocusOut:!0});if(!i)return;let o=new Map;switch(i.label){case"Classic module, imported":o.set("module","app");break;case"Module with routing, imported":o.set("routing","true"),o.set("module","app");break;case"Lazy-loaded module":o.set("route",t),o.set("module","app")}return"Advanced module"===i.label&&(o=yield this.askOptions(e)),o}))}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function a(e){try{r(i.next(e))}catch(e){s(e)}}function c(e){try{r(i.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}r((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),s=n(1),a=n(3);t.Generate=class{constructor(e,t){this.path="",this.project="",this.schema="",this.defaultOption="",this.base="ng g",this.collection=a.AngularConfig.cliCollection,this.options=new Map,this.cliLocal=null,this.path=this.getCommandPath(e),this.project=this.getProject(e,t)}get command(){return[this.base,this.formatCollectionAndSchema(),this.defaultOption,...this.formatOptionsForCommand()].join(" ")}addCollection(e){this.collection=e}addSchema(e){this.schema=e}addDefaultOption(e,t=!0){this.defaultOption=e,t&&this.project&&this.project!==a.AngularConfig.rootProject&&this.addOption("project",this.project)}addOption(e,t){this.options.set(e,t)}askConfirmation(){return i(this,void 0,void 0,(function*(){return"Confirm"===(yield o.window.showQuickPick(["Confirm","Cancel"],{placeHolder:this.command,ignoreFocusOut:!0}))}))}isCliLocal(e){return i(this,void 0,void 0,(function*(){return null===this.cliLocal&&(this.cliLocal=yield s.Utils.existsAsync(s.Utils.getNodeModulesPath(e,".bin","ng"))),this.cliLocal}))}getExecCommand(e){return i(this,void 0,void 0,(function*(){return(yield this.isCliLocal(e))?`"./node_modules/.bin/ng"${this.command.substr(2)}`:this.command}))}resetCommandPath(e=""){this.path=this.getCommandPath(e)}getProject(e,t){const n=e.substr(e.indexOf(t)+t.length),i=s.Utils.normalizePath(n);for(const[e,t]of a.AngularConfig.projects){const n=i.substr(1);if(n===t||n.startsWith(`${t}/`))return e}const o=i.match(/projects\/([^\/]+)\/[^\/]+\/(?:app|lib)/);if(o)return o[1];{const e=i.match(/projects\/([^\/]+\/[^\/]+)\/[^\/]+\/(?:app|lib)/);if(e)return`@${e[1]}`}return""}getCommandPath(e=""){const t=s.Utils.normalizePath(e),n=t.match(/[^\/]+\/((?:app|lib))\//);if(n){const e=t.split(`/${n[1]}/`)[1];return e.includes(".")?"ngx-spec"===this.collection?e:s.Utils.getDirectoryFromFilename(e):`${e}/`}return""}formatOptionsForCommand(){return Array.from(this.options.entries()).map(e=>"true"===e[1]?`--${e[0]}`:Array.isArray(e[1])?e[1].map(t=>`--${e[0]} ${t}`).join(" "):`--${e[0]} ${e[1]}`)}formatCollectionAndSchema(){return this.collection!==a.AngularConfig.cliCollection?`${this.collection}:${this.schema}`:this.schema}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function a(e){try{r(i.next(e))}catch(e){s(e)}}function c(e){try{r(i.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}r((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),s=n(0),a=n(1),c=n(4),r=n(3);class l{static init(e){return i(this,void 0,void 0,(function*(){const t=o.join(e,this.configPath);if(!this.config){(yield a.Utils.existsAsync(t))&&(this.config=yield a.Utils.parseJSONFile(t),this.userComponentSuffixes=this.getUserComponentSuffixes(this.config));const n=new Set(["Component",...this.userComponentSuffixes||["Page","Pure","Entry","Exported","Element"]]);if(this.userComponentSuffixes){let e=!1,t=!1,i=!1,o=!1,s=!1;n.forEach(n=>{const a=n.toLowerCase();c.Preferences.getComponentTypes("pure").includes(a)?e=!0:c.Preferences.getComponentTypes("page").includes(a)?t=!0:c.Preferences.getComponentTypes("runtime").includes(a)?i=!0:c.Preferences.getComponentTypes("exported").includes(a)?o=!0:c.Preferences.getComponentTypes("element").includes(a)&&(s=!0)}),t||n.add("Page"),e||n.add("Pure"),r.AngularConfig.isIvy||i||n.add("Entry"),o||n.add("Exported"),s||n.add("Element")}this.componentSuffixes=Array.from(n),this.watcher||(this.watcher=s.workspace.createFileSystemWatcher(t,!0,void 0,!0),this.watcher.onDidChange(()=>{this.config=null,this.init(e)}))}}))}static getUserComponentSuffixes(e){return e&&e.rules&&Array.isArray(e.rules["component-class-suffix"])&&e.rules["component-class-suffix"].length>2?e.rules["component-class-suffix"].slice(1):[]}}t.TSLintConfig=l,l.configPath="tslint.json",l.componentSuffixes=[],l.userComponentSuffixes=[],l.config=null}]);
//# sourceMappingURL=extension.js.map